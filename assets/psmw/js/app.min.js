/**
 * Premium Stock Market Widgets
 * ---------------------------------------------
 * Version 1.8.3, built on Tuesday, November 14, 2017
 * Copyright (c) Financial Apps and Plugins <info@financialplugins.com>. All rights reserved.
 * Demo: http://financialplugins.com/products/premium-stock-market-widgets
 * Purchase: https://codecanyon.net/item/premium-stock-market-widgets-js-php/19714578?ref=financialtechnology
 * Like: https://www.facebook.com/financialplugins/
 */
var smwPathToAssets=smwPathToAssets||"",smwGlobals={debug:!1,code:"smw",ajaxUrl:smwPathToAssets+"/psmw/ajax.php",pluginUrl:smwPathToAssets+"/psmw/",dependencies:{marquee:smwPathToAssets+"/psmw/vendor/jquery.marquee/jquery.marquee.min.js",tablesort:smwPathToAssets+"/psmw/vendor/jquery.tablesort/jquery.tablesort.min.js",sparkline:smwPathToAssets+"/psmw/vendor/jquery.sparkline/jquery.sparkline.min.js",chart:smwPathToAssets+"/psmw/vendor/chart.js/Chart.min.js"}},premiumStockMarketWidgetsPlugin=function(e){function a(a){return f=e(document),p=e(g),m("Initialize",p.length+" widgets"),h=e.Deferred(),y=e.Deferred(),e.when(h,y).done(function(){p.trigger("psmwReadyGlobal")}),l(p),0!=p.length&&(f.off("psmwReadyGlobal",p).off("mouseenter",g+" .smw-combo table tbody tr"),f.on("psmwReadyGlobal",p,i).on("click",".smw-modal-close",function(){e(this).closest(".smw-modal").hide()}),void t(p,a))}function t(a,t){n(a);var t="undefined"==typeof t||t,o=s(a),i=[],l=[],d=[],u=e(),c=e(),f=e();a.each(function(a,t){var s=e(t),r=s.data("symbol"),n=s.data("source"),o=s.data("type");if("live"==n){u=u.add(s);for(var m=r?r.split(","):[],p=0;p<m.length;p++)e.inArray(m[p],i)<0&&i.push(m[p])}else"history"==n&&("spark"==o?(l.push(r),c=c.add(s)):"chart"==o&&(d.push(r),f=f.add(s)))});var p=l.length,h=d.length;x+=p+h+(i.length?1:0),m("Number of AJAX calls to make",x);for(var y=0;y<p;y++){var v=c.eq(y);r(v,{source:"history",symbols:l[y].split(","),type:"spark"},t)}for(var y=0;y<h;y++){var g=f.eq(y);r(g,{source:"history",symbols:d[y].split(","),type:"chart",chart_range:g.data("range"),chart_interval:g.data("interval")},t)}i.length&&o.length&&r(u,{source:"live",symbols:i,fields:o},t)}function s(a){var t=[];return a.find(b).each(function(a,s){var s=e(s).data("field").replace("_","");e.inArray(s,t)<0&&t.push(s)}),t}function r(a,t,s,r){s?(m("Get market data from SERVER",t.source,t),e.isEmptyObject(t)||e.ajax({method:smwGlobals.ajaxMethod,url:smwGlobals.ajaxUrl,dataType:"json",cache:!1,context:{source:t.source,symbol:t.symbols,$widgetContainers:a},data:{params:t},success:function(a){m("Market data received",this.source,a),x--,a.success?(e.extend(!0,G,a.data),m("Market data cached",G),"function"==typeof t.callback?t.callback():o(this.$widgetContainers,G)):m("ERROR response received",a.data)}})):(m("Get market data from CACHE",t.source,t),x--,o(a,G))}function n(a){a.each(function(a,t){var s=e(t).data("dependency");if(s){s=s.split(",");for(var r=0;r<s.length;r++)e.inArray(s[r],A)<0&&A.push(s[r])}});var t=A.length;if(t>C)for(var s=0;s<t;s++){var r=smwGlobals.dependencies[A[s]];"undefined"==typeof j[r]&&(m("Loading JS file",r),j[r]=e.ajax({url:r,dataType:"script",cache:!0}).done(function(){C++,m("JS file loaded",r),C==A.length&&(m("All plugins loaded"),y.resolve())}))}else y.resolve()}function o(a,t){a.each(function(a,s){var r=e(s);r.find(b).each(function(a,s){var n=e(s),o=n.data("field"),i=n.data("symbol")?n.data("symbol"):r.data("symbol"),l="undefined"!=typeof t[i]&&"undefined"!=typeof t[i][o]?t[i][o]:"";n.addClass("smw-field-"+o.replace(".","-")),n.text(l);var d=n.data("previous-value");"undefined"!=typeof d&&d!=l&&n.animate({opacity:0},200).animate({opacity:1},200).animate({opacity:0},200).animate({opacity:1},200),n.data("previous-value",l)}),r.find(w).each(function(a,s){var n=e(s),o=n.data("symbol")?n.data("symbol"):r.data("symbol"),i="undefined"!=typeof t[o]&&"undefined"!=typeof t[o]["quote.regularMarketChange"]?parseFloat(t[o]["quote.regularMarketChange"]):0;i>0?n.removeClass("smw-drop").addClass("smw-rise"):i<0?n.removeClass("smw-rise").addClass("smw-drop"):n.removeClass("smw-drop smw-rise")})}),0==x&&(m("All AJAX requests completed"),h.resolve())}function i(a){var t=e(a.target);m("psmwReadyGlobal",t.attr("id"),t.attr("class")),t.hasClass("smw-visible")||t.addClass("smw-visible")}function l(e){e.each(function(e,a){var t=a.className.split(/\s+/);t.length>=3&&d(smwGlobals.pluginUrl+"templates/"+t[1].substr(4)+"/"+t[2].substr(4)+"/style.css")})}function d(a){e.inArray(a,k)<0&&(m("Loading CSS file",a),e("<link>").appendTo("head").attr({type:"text/css",rel:"stylesheet",href:a}),k.push(a))}function u(e,a,t){if(e.hasClass(v+"-Int")||e.hasClass(v+"-Decimal")||e.hasClass(v+"-Percent"))return parseFloat(a.text().replace(/[^0-9.-]/g,""));if(e.hasClass(v+"-BigNumber")){var s={K:1e3,M:1e6,B:1e9},r=a.text(),n=r.substr(-1);if(s.hasOwnProperty(n))var o=parseFloat(r.replace(/[^0-9.]/g,""))*s[n];else var o=parseFloat(r.replace(/[^0-9.]/g,""));return o}return a.text()}function c(){var e=window.navigator.userAgent;return e.indexOf("MSIE ")>0||e.indexOf("Trident/")>0||e.indexOf("Edge/")>0}function m(){0!=smwGlobals.debug&&console.log("PSMW",arguments)}m("globals",smwGlobals);var f,p,h,y,v=smwGlobals.code,g="."+v,b="."+v+"-market-data-field",w="."+v+"-change-indicator",k=[],j={},A=[],C=0,x=0,G={};return e(document).ready(function(){a(!0)}),{init:a,getMarketData:function(){return G},getWidgetsFields:s,tablesortGetValue:u,retrieveMarketData:r,checkIE:c,log:m}}(jQuery);"undefined"==typeof Number.prototype.formatNumber&&(Number.prototype.formatNumber=function(){var e="undefined"!=typeof arguments[0]?arguments[0]:2,a="undefined"!=typeof arguments[1]?arguments[1]:"en-US";return this.toLocaleString(a,{minimumFractionDigits:e,maximumFractionDigits:e})});